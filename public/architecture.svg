<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="700" viewBox="0 0 1200 700">
  <style>
    .title { font: 700 20px 'Segoe UI', Roboto, Arial; fill: #0f172a; }
    .label { font: 600 13px 'Segoe UI', Roboto, Arial; fill: #0f172a; }
    .note { font: 400 12px 'Segoe UI', Roboto, Arial; fill: #475569; }
    .box { fill: #ffffff; stroke: #e6e9ee; stroke-width: 2; rx: 10; }
    .cloud { fill: #eef2ff; stroke: #c7d2fe; stroke-width: 2; rx: 18; }
    .line { stroke: #94a3b8; stroke-width: 2; marker-end: url(#arrow); }
  </style>

  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#94a3b8" />
    </marker>
  </defs>

  <rect x="20" y="20" width="1160" height="50" fill="none" />
  <text x="30" y="55" class="title">IRELIA - Voice Negotiation Agent (Architecture)</text>

  <!-- Browser / Client -->
  <g transform="translate(40,100)">
    <rect class="cloud" x="0" y="0" width="300" height="120" />
    <text x="20" y="28" class="label">Client (Browser)</text>
    <text x="20" y="52" class="note">Next.js app (React)</text>
    <text x="20" y="70" class="note">@elevenlabs/react (WebRTC voice)</text>
    <text x="20" y="90" class="note">UI: sliders, controls, timers</text>
  </g>

  <!-- Server -->
  <g transform="translate(430,70)">
    <rect class="box" x="0" y="0" width="320" height="180" />
    <text x="18" y="28" class="label">Server (Next.js API)</text>
    <text x="18" y="54" class="note">Server-only env: ELEVENLABS_API_KEY</text>
    <text x="18" y="74" class="note">Endpoint: /api/conversation-token</text>
    <text x="18" y="98" class="note">Mints short-lived conversational tokens</text>
    <text x="18" y="122" class="note">Session lifecycle & security</text>
  </g>

  <!-- ElevenLabs Conversational API -->
  <g transform="translate(820,100)">
    <rect class="cloud" x="0" y="0" width="300" height="120" />
    <text x="20" y="28" class="label">ElevenLabs Conversational AI</text>
    <text x="20" y="56" class="note">Agent (ELEVENLABS_AGENT_ID)</text>
    <text x="20" y="76" class="note">WebRTC + audio stream</text>
    <text x="20" y="96" class="note">Contextual updates received from client</text>
  </g>

  <!-- Buyers / UI simulation -->
  <g transform="translate(40,240)">
    <rect class="box" x="0" y="0" width="1160" height="120" />
    <text x="18" y="28" class="label">Simulated Buyers (Client state)</text>
    <text x="18" y="54" class="note">Three buyer sliders, price state</text>
    <text x="18" y="74" class="note">Market snapshots sent every second</text>
    <text x="18" y="94" class="note">User offers & accept actions</text>
  </g>

  <!-- Connections -->
  <path class="line" d="M 340 160 L 430 160" />
  <path class="line" d="M 750 160 L 820 160" />
  <path class="line" d="M 300 280 L 430 200" />
  <path class="line" d="M 750 200 L 980 200" />

  <text x="360" y="150" class="note">Request conversation token</text>
  <text x="635" y="150" class="note">Short-lived token</text>

  <!-- Footer notes -->
  <text x="30" y="620" class="note">Notes: State is ephemeral; no DB persistence. Server mints tokens and keeps API key server-side only.</text>

</svg>
